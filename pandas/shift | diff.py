
''' origin data '''
        USRID        EVT_LBL              OCC_TIM  TCH_TYP  day  
0        1000    162-574-910  2018-03-23 11:48:51        0   23  
1        1000   257-922-1523  2018-03-14 13:31:01        0   14  
2        1000   257-922-1523  2018-03-23 10:14:31        0   23  
3        1000   257-922-1523  2018-03-23 11:46:23        0   23  
4        1000   259-924-1525  2018-03-23 11:46:25        0   23  
5        1000   259-924-1525  2018-03-25 12:22:23        0   25   
6        1000  326-1041-1678  2018-03-06 09:22:33        0    6   
7        1000  326-1041-1678  2018-03-23 11:46:31        0   23   
8       10005   257-922-1523  2018-03-04 23:43:10        0    4    
9       10005  326-1041-1678  2018-03-04 23:43:31        0    4  
10      10009  326-1046-1711  2018-03-16 11:35:27        0   16    
11      10009  520-1836-3640  2018-03-16 11:45:39        0   16    
12      10018  326-1041-1678  2018-03-07 16:59:29        0    7   
13      10018  326-1041-1678  2018-03-14 16:55:50        0   14     
14      10018  326-1042-1703  2018-03-31 12:42:26        0   31    
15      10018  359-1234-2004  2018-03-19 18:34:58        0   19    


''' method one '''
test_log['day'] = test_log.apply(lambda index: int(index.OCC_TIM.split(' ')[0].split('-')[2]), axis=1)      # day #
test_log['day_diff'] = test_log.groupby('USRID')['day'].apply(lambda i: i.diff(1))
print(test_log)

''' method two '''
test_log['day'] = test_log.apply(lambda index: int(index.OCC_TIM.split(' ')[0].split('-')[2]), axis=1)      # day #
test_log['day_diff1'] = test_log.groupby('USRID')['day'].apply(lambda i: i.shift(1))
test_log['day_diff'] = test_log['day_diff1'] - test_log['day']
print(test_log)


''' data after transfer '''
        USRID        EVT_LBL              OCC_TIM  TCH_TYP  day  day_diff
0        1000    162-574-910  2018-03-23 11:48:51        0   23       NaN
1        1000   257-922-1523  2018-03-14 13:31:01        0   14      -9.0
2        1000   257-922-1523  2018-03-23 10:14:31        0   23       9.0
3        1000   257-922-1523  2018-03-23 11:46:23        0   23       0.0
4        1000   259-924-1525  2018-03-23 11:46:25        0   23       0.0
5        1000   259-924-1525  2018-03-25 12:22:23        0   25       2.0
6        1000  326-1041-1678  2018-03-06 09:22:33        0    6     -19.0
7        1000  326-1041-1678  2018-03-23 11:46:31        0   23      17.0
8       10005   257-922-1523  2018-03-04 23:43:10        0    4       NaN
9       10005  326-1041-1678  2018-03-04 23:43:31        0    4       0.0
10      10009  326-1046-1711  2018-03-16 11:35:27        0   16       NaN
11      10009  520-1836-3640  2018-03-16 11:45:39        0   16       0.0
12      10018  326-1041-1678  2018-03-07 16:59:29        0    7       NaN
13      10018  326-1041-1678  2018-03-14 16:55:50        0   14       7.0
14      10018  326-1042-1703  2018-03-31 12:42:26        0   31      17.0
15      10018  359-1234-2004  2018-03-19 18:34:58        0   19     -12.0


